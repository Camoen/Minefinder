<!doctype html>
<html>
  <head>
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <!-- TODO: Pick static version and use minified version (pixi.min.js) -->
    <script src="https://pixijs.download/release/pixi.js"></script>
  </head>
  <body>
    <div id="app">
      <v-app>
        <div class="flex-container">
          <div>
            <div v-if="modeSelected !== null" v-cloak>
              <h3>{{modeSelected}}</h3>
              <v-btn raised @click="deselectGameMode()">Back to Menu</v-btn>
            </div>
            <div v-else v-cloak>
              <h3 style="text-align:center">Select Mode</h3>
              <v-btn raised v-for="mode in gameModes" :key="mode.id" @click="selectGameMode(mode)">{{mode}}</v-btn>
            </div>
          </div>
          <div id="game" v-show="modeSelected === this.gameModes[0]"></div>
          <div id="roomSelection" v-show="modeSelected === this.gameModes[1]">
            <div v-if="loggedIn" v-cloak>
              <h3 style="text-align:center">Hello, {{username}}!<br>Select or Create a Room<br>(TODO)</h3>
              <v-btn
                block
                color="success"
                size="large"
                type="submit"
                variant="elevated"
                @click="logOut()">Change Username</v-btn>
            </div>
            <div v-else v-cloak>
              <v-form v-model="form" @submit.prevent="createUser">
                <v-text-field 
                  label="Username"
                  clearable
                  placeholder="Minefinder#123"
                  hint="Provide a username to join or create a room."
                  :rules="[
                    v => !!v || 'Field is required'
                  ]"
                  v-model="username"></v-text-field>
                <v-btn
                  :disabled="!form"
                  block
                  color="success"
                  size="large"
                  type="submit"
                  variant="elevated">Select Username</v-btn>
              </v-form>
            </div>
          </div>

          <div></div>
        </div> 
      </v-app>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script>
      const socket = io();
      const vuetify = new Vuetify({
        theme: {
          options: {
            customProperties: true,
          },
          themes: {
            light: {
              background: '#5f9ea0',
            },
            dark: {
              background: '#777777',
            },
          },
            dark: false,
        },
      });
      const vueApp = new Vue({
        el: '#app',
        vuetify: vuetify,

        data: {
          form: false,
          gameModes: ["Individual", "Multiplayer"],
          loggedIn: false,
          modeSelected: null,
          username: null
        },

        created() {},
        methods: {
          createUser() {
		  			this.loggedIn = true;
		  			socket.emit('user-created', this.username);
            console.log(this);
		  		},

          deselectGameMode(){
            this.modeSelected = null;
          },

          selectGameMode(mode) {
            this.modeSelected = mode;
            console.log(mode);
          },

          logOut(){
            this.loggedIn = false;
            socket.emit('user-deleted', this.username);
          }
        }
      });

    </script>
    <script src="./minefinder.js"></script>
  </body>
</html>

<!-- Code borrowed from https://pixijs.io/guides/basics/getting-started.html -->